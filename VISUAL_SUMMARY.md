# Complete Authentication & Enrollment System - Visual Summary

## ğŸ¯ Three Enrollment Scenarios Implemented

### Scenario 1: New User Enrolling âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                   â”‚
â”‚  User browses /courses                                           â”‚
â”‚         â†“                                                         â”‚
â”‚  Clicks "Enroll Now"                                             â”‚
â”‚         â†“                                                         â”‚
â”‚  System checks: isAuthenticated?                                 â”‚
â”‚         â”‚                                                         â”‚
â”‚         â”œâ”€ NO â”€â†’ Redirect to /auth/signup                        â”‚
â”‚         â”‚        with message: "Sign up to enroll"              â”‚
â”‚         â†“                                                         â”‚
â”‚  Fill registration form (name, email, password)                 â”‚
â”‚         â†“                                                         â”‚
â”‚  Email verification with OTP (6 digits, 10 min)                â”‚
â”‚         â†“                                                         â”‚
â”‚  Redirect to /auth/login                                        â”‚
â”‚         â†“                                                         â”‚
â”‚  Login with email & password                                    â”‚
â”‚         â†“                                                         â”‚
â”‚  AuthContext updates: isAuthenticated = true                    â”‚
â”‚         â†“                                                         â”‚
â”‚  AUTOMATICALLY redirect to /enrollment/course-id                â”‚
â”‚         â†“                                                         â”‚
â”‚  Enrollment page displays with pre-filled user info             â”‚
â”‚         â†“                                                         â”‚
â”‚  User reviews & clicks "Complete Enrollment"                    â”‚
â”‚         â†“                                                         â”‚
â”‚  âœ… Enrollment successful!                                       â”‚
â”‚         â†“                                                         â”‚
â”‚  Redirect to /dashboard                                         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Scenario 2: Existing User (Not Logged In) Enrolling âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                   â”‚
â”‚  User browses /courses                                           â”‚
â”‚         â†“                                                         â”‚
â”‚  Clicks "Enroll Now"                                             â”‚
â”‚         â†“                                                         â”‚
â”‚  System checks: isAuthenticated?                                 â”‚
â”‚         â”‚                                                         â”‚
â”‚         â”œâ”€ NO â”€â†’ Redirect to /auth/login                         â”‚
â”‚         â”‚                                                         â”‚
â”‚         â†“                                                         â”‚
â”‚  Enter email & password                                         â”‚
â”‚         â†“                                                         â”‚
â”‚  Login successful                                                â”‚
â”‚         â†“                                                         â”‚
â”‚  AuthContext updates with user data                             â”‚
â”‚         â†“                                                         â”‚
â”‚  AUTOMATICALLY redirect to /enrollment/course-id                â”‚
â”‚         â†“                                                         â”‚
â”‚  Enrollment page displays with pre-filled user info             â”‚
â”‚         â†“                                                         â”‚
â”‚  User clicks "Complete Enrollment"                              â”‚
â”‚         â†“                                                         â”‚
â”‚  âœ… Enrollment successful!                                       â”‚
â”‚         â†“                                                         â”‚
â”‚  Redirect to /dashboard                                         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Scenario 3: Authenticated User Enrolling âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                   â”‚
â”‚  User already logged in (isAuthenticated = true)                â”‚
â”‚         â†“                                                         â”‚
â”‚  User browses /courses                                           â”‚
â”‚         â†“                                                         â”‚
â”‚  AuthContext initialized on page load:                          â”‚
â”‚  - Checks localStorage for accessToken                          â”‚
â”‚  - Verifies token validity via GET /api/auth/me                 â”‚
â”‚  - Loads user data                                              â”‚
â”‚  - Sets isAuthenticated = true                                  â”‚
â”‚         â†“                                                         â”‚
â”‚  Clicks "Enroll Now"                                             â”‚
â”‚         â†“                                                         â”‚
â”‚  System checks: isAuthenticated?                                 â”‚
â”‚         â”‚                                                         â”‚
â”‚         â”œâ”€ YES â”€â†’ DIRECT redirect to /enrollment/course-id      â”‚
â”‚         â”‚        (NO redirect to login required)                â”‚
â”‚         â†“                                                         â”‚
â”‚  Enrollment page displays with pre-filled user info             â”‚
â”‚         â†“                                                         â”‚
â”‚  User reviews & clicks "Complete Enrollment"                    â”‚
â”‚         â†“                                                         â”‚
â”‚  âœ… Enrollment successful!                                       â”‚
â”‚         â†“                                                         â”‚
â”‚  Redirect to /dashboard                                         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          FRONTEND (React)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              AuthProvider Wrapper                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  AuthContext (Global State)                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ user: User | null                            â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ isAuthenticated: boolean                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ isLoading: boolean                            â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€ methods: login, logout, register, etc.       â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  Routes (React Router)                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ Public: /courses, /auth/*, /               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€ Protected: /enrollment/*, /dashboard       â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Components                                             â”‚    â”‚
â”‚  â”‚  â”œâ”€ CourseDetail.tsx (Enroll button logic)             â”‚    â”‚
â”‚  â”‚  â”œâ”€ Enrollment.tsx (Enrollment form)                   â”‚    â”‚
â”‚  â”‚  â”œâ”€ ProtectedRoute (Route protection)                  â”‚    â”‚
â”‚  â”‚  â””â”€ Login/Signup/VerifyEmail (Auth pages)             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Services                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€ api.ts (Axios + Interceptors for token refresh)   â”‚    â”‚
â”‚  â”‚  â””â”€ auth.service.ts (Auth API calls)                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Local Storage                                          â”‚    â”‚
â”‚  â”‚  â”œâ”€ accessToken (JWT, 15 min)                         â”‚    â”‚
â”‚  â”‚  â”œâ”€ user (JSON)                                        â”‚    â”‚
â”‚  â”‚  â””â”€ enrollmentRedirect (temporary)                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ HTTP Requests (Axios)
         â”‚ + Authorization Header
         â”‚ + Auto Token Refresh
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BACKEND (Express.js + TypeScript)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  API Routes (/api/auth/*)                              â”‚    â”‚
â”‚  â”‚  â”œâ”€ POST /register                                      â”‚    â”‚
â”‚  â”‚  â”œâ”€ POST /verify-email                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€ POST /login                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€ GET /me (protected)                               â”‚    â”‚
â”‚  â”‚  â”œâ”€ POST /logout (protected)                          â”‚    â”‚
â”‚  â”‚  â””â”€ POST /refresh-token                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Middlewares                                            â”‚    â”‚
â”‚  â”‚  â”œâ”€ authenticate (JWT verification)                    â”‚    â”‚
â”‚  â”‚  â”œâ”€ validate (Input validation)                        â”‚    â”‚
â”‚  â”‚  â””â”€ errorHandler (Error handling)                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  AuthService (Business Logic)                          â”‚    â”‚
â”‚  â”‚  â”œâ”€ register()                                         â”‚    â”‚
â”‚  â”‚  â”œâ”€ verifyEmail()                                      â”‚    â”‚
â”‚  â”‚  â”œâ”€ login()                                            â”‚    â”‚
â”‚  â”‚  â”œâ”€ logout()                                           â”‚    â”‚
â”‚  â”‚  â””â”€ getMe()                                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Utilities                                              â”‚    â”‚
â”‚  â”‚  â”œâ”€ jwt.ts (Token generation & verification)          â”‚    â”‚
â”‚  â”‚  â”œâ”€ password.ts (Hashing & validation)                â”‚    â”‚
â”‚  â”‚  â”œâ”€ email.ts (OTP & reset templates)                  â”‚    â”‚
â”‚  â”‚  â””â”€ response.ts (Standardized responses)              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Database Queries
         â”‚ Cache Operations
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                              â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MongoDB         â”‚        â”‚   Redis          â”‚      â”‚   Email     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚      â”‚   Service   â”‚
â”‚   â”‚ users     â”‚   â”‚        â”‚   â”‚ verify_  â”‚   â”‚      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ enrolls   â”‚   â”‚        â”‚   â”‚ email    â”‚   â”‚      â”‚ â”‚ SMTP    â”‚ â”‚
â”‚   â”‚ courses   â”‚   â”‚        â”‚   â”‚ sessions â”‚   â”‚      â”‚ â”‚ Nodema  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚        â”‚   â”‚ reset_   â”‚   â”‚      â”‚ â”‚ iler    â”‚ â”‚
â”‚                   â”‚        â”‚   â”‚ password â”‚   â”‚      â”‚ â”‚         â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                             â”‚   (OTP expiry   â”‚      â”‚ (Gmail      â”‚
                             â”‚    10-15 min)   â”‚      â”‚  SMTP)      â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USER REGISTRATION FLOW                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  Frontend                     Backend                Database     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                   â”‚
â”‚  Input form data                                                â”‚
â”‚         â†“                                                         â”‚
â”‚  POST /register â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Validate input                    â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Hash password                      â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Check email unique                 â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Create user â”€â”€â”€â”€â”€â†’ MongoDB users  â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Generate OTP (6 digits)            â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Store OTP in Redis â”€â”€â†’ Redis      â”‚
â”‚         â”‚                    (expires: 10 min)      verify_      â”‚
â”‚         â”‚                            â†“             email:UUID   â”‚
â”‚         â”‚                    Send email with OTP                â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Return userId                  â”‚
â”‚         â†“                                                        â”‚
â”‚  Show verify email page                                        â”‚
â”‚  Input OTP                                                      â”‚
â”‚         â†“                                                        â”‚
â”‚  POST /verify-email â”€â”€â”€â”€â”€â”€â”€â”€â†’ Check OTP in Redis â”€â”€â†’ Redis    â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Update user:                       â”‚
â”‚         â”‚                    isEmailVerified = true â”€â”€â†’ MongoDB â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â”‚                    Delete OTP from Redis â”€â”€â†’ Redis   â”‚
â”‚         â”‚                            â†“                          â”‚
â”‚         â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Return success                 â”‚
â”‚         â†“                                                        â”‚
â”‚  Redirect to login                                             â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ Key Integration Points

### 1. AuthContext Integration
```typescript
// Any component can use:
const { user, isAuthenticated, login, logout } = useAuth();
```

### 2. Protected Route Integration
```typescript
<ProtectedRoute>
  <EnrollmentPage />
</ProtectedRoute>
```

### 3. API Interceptor Integration
```typescript
// Automatic on every request:
// 1. Add Authorization header
// 2. On 401: Refresh token
// 3. Retry request with new token
```

### 4. State Preservation
```typescript
// Enrollment data persists across redirects:
localStorage.setItem('enrollmentRedirect', url);
```

---

## âœ… Checklist - What's Implemented

### Backend
- âœ… User Registration with validation
- âœ… Email Verification with OTP
- âœ… Password Hashing (bcrypt)
- âœ… JWT Token Generation
- âœ… Token Refresh Mechanism
- âœ… User Login
- âœ… User Logout
- âœ… Get Current User
- âœ… Password Reset
- âœ… CORS Configuration
- âœ… Error Handling Middleware
- âœ… Input Validation
- âœ… Protected Routes

### Frontend
- âœ… Auth Context for Global State
- âœ… ProtectedRoute Component
- âœ… Login Page
- âœ… Registration Page
- âœ… Email Verification Page
- âœ… Enrollment Page
- âœ… CourseDetail with Enroll Button
- âœ… API Interceptors
- âœ… Token Refresh Logic
- âœ… Protected Routes
- âœ… Role-based Access Control
- âœ… Loading States
- âœ… Error Handling

### Database
- âœ… MongoDB User Schema
- âœ… Redis OTP Storage
- âœ… Session Storage
- âœ… Password Reset Token Storage

---

## ğŸ“ˆ User Journey Map

```
Visit App
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           â”‚                  â”‚
Already Have Account?   No Account Yet?      Coming Back?
â”‚                           â”‚                  â”‚
â†“                           â†“                  â†“
Login                  Sign Up              Check Token
â”‚                           â”‚                  â”‚
â”œâ”€ Valid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”œâ”€ Verify â”€â”    â”œâ”€ Valid â”€â”€â”€â”€â”€â”
â”‚                 â†“   â”‚    Email   â”‚    â”‚              â†“
Auth âœ“         OTP   â”‚             â†“    â”‚           Auth âœ“
â”‚              â”‚      â”‚        Login     â”‚
â”‚              â†“      â†“         â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Auth âœ“ â†â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
               â”‚                        â†“
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Auth âœ“ â†â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“                 â†“
              View Course        Direct
              Click Enroll       Enrollment
                    â”‚                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
                    Enrollment Page
                             â†“
                    Complete Enrollment
                             â†“
                          Dashboard
```

---

## ğŸ¯ Key Features Summary

| Feature | Frontend | Backend | Database |
|---------|----------|---------|----------|
| Registration | âœ… Form | âœ… Validation | âœ… User Model |
| Email Verification | âœ… OTP Input | âœ… OTP Generate | âœ… Redis Store |
| Login | âœ… Login Form | âœ… JWT Create | âœ… User Query |
| Logout | âœ… Logout Button | âœ… Session Clear | âœ… Redis Delete |
| Token Refresh | âœ… Interceptor | âœ… Token Gen | âœ… Session Check |
| Protected Routes | âœ… Check Auth | âœ… JWT Verify | âœ… N/A |
| Enrollment | âœ… Form + Logic | â³ API Endpoint | â³ Enroll Model |
| Password Reset | âœ… Forms | âœ… Token Gen | âœ… Redis + Mongo |

---

## ğŸš€ Production Checklist

Before deploying to production:

- [ ] Set strong JWT_SECRET and JWT_REFRESH_SECRET
- [ ] Enable HTTPS only
- [ ] Configure real email service (not local)
- [ ] Set up MongoDB Atlas or managed service
- [ ] Set up Redis Cloud or managed service
- [ ] Configure CORS with production domain
- [ ] Set NODE_ENV=production
- [ ] Enable security headers
- [ ] Setup monitoring and logging
- [ ] Test token refresh mechanism
- [ ] Setup CI/CD pipeline
- [ ] Enable rate limiting
- [ ] Setup backup strategy

---

**Status:** âœ… Complete Implementation Ready for Testing & Deployment
